---
title: Analysis of experimental data
subtitle: "{{< var workshop-title >}}"
format:
  anu-light-revealjs:
    width: 1920
    height: 1080
    auto-stretch: false
    html-math-method: katex
    self-contained: false
    css: 
     - /assets/slides.css
    footer: "{{< var workshop-url >}}"
author: Emi Tanaka
institute: Biological Data Science Institute
date-talk: "20th September 2024"
filters:
  - webr
execute: 
  echo: true
webr: 
  show-startup-message: false  
  packages: 
    - edibble
---


## {{< fa crosshairs >}} Current learning objective

```{r, include = FALSE}
library(tidyverse)
source("setup.R")
```


```{r}
#| results: asis 
#| echo: false
learning_objectives(4:5)
```


## Analysis of experimental data

::: incremental

- Analysis of experimental data depends on various context. 
- <i class="fas fa-exclamation-circle"></i> We cannot cover all types of analysis in a short period!
- We'll cover **two-sample tests**, **linear regression** and analysis of variance (**ANOVA**) for some types of experimental data.
- Two-sample tests and ANOVA can be in fact just formulated as a linear regression.

:::

## Completely randomised design 

```{webr-r}
library(edibble)
des1 <- design("CRD Cow Experiment") |> 
  set_units(cow = 6) |> 
  set_trts(supp = c("new", "control")) |> 
  allot_table(supp ~ cow)

des1
```



## Simulate the experimental data

```{webr-r}
data1 <- des1 |> 
  set_rcrds(milk_yield = cow) |> 
  simulate_process(milk_yield = function(diff = 1) {
      effects <- c(new = diff, control = 0)
      rnorm(n(), 5 + effects[supp], 1) 
  }) |> 
  simulate_rcrds(milk_yield = with_params(diff = 5))
```



## Statistical analysis plan

::: f2

**Analysis of variance**

```{r}
#| eval: false
options(knitr.kable.NA = '')
anova(lm(Weight ~ Treatment + Glasshouse, data = df10v4)) |> 
  knitr::kable(digits = 3)
```

**Estimated regression parameters**

```{r}
#| eval: false
summary(lm(Weight ~ Treatment + Glasshouse, data = df10v4)) |> 
  broom::tidy() |> 
  mutate(Term = c("Intercept", "Treatment", "Glasshouse")) |> 
  select(Term, Estimate = estimate, `Std Error` = std.error, `P value` = p.value) |> 
  knitr::kable(digits = 3)
```

:::

## Analysis of variance (ANOVA)


## Linear models 

- ANOVA is a special case of linear models

## Common diagnostics 

- Check the residual plot 
- Outliers 
- Transformation of data
- Multiple comparisons 

## Summary 

